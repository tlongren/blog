---
title: Unwakeable XSS Vulnerability
author: Tyler Longren
type: post
date: 2007-09-03T20:47:20+00:00
url: /unwakeable-xss-vulnerability/
views:
  - 2380
ratings_users:
  - 6
ratings_score:
  - 25
ratings_average:
  - 4.17
dsq_thread_id:
  - 1385917325
pageViews:
  - '{"hours":{"1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"","32":"","33":"","34":"","35":"","36":"","37":"","38":"","39":"","40":"","41":"","42":"","43":"","44":"","45":"","46":"","47":""},"days":{"2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":""},"weeks":{"3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":""},"months":{"4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":""}}'
pageViews_cumul:
  - '{"hours":{"1":"","2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":"","25":"","26":"","27":"","28":"","29":"","30":"","31":"","32":"","33":"","34":"","35":"","36":"","37":"","38":"","39":"","40":"","41":"","42":"","43":"","44":"","45":"","46":"","47":""},"days":{"2":"","3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":""},"weeks":{"3":"","4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":""},"months":{"4":"","5":"","6":"","7":"","8":"","9":"","10":"","11":"","12":"","13":"","14":"","15":"","16":"","17":"","18":"","19":"","20":"","21":"","22":"","23":"","24":""}}'
tags:
  - Internet
  - Noteworthy
  - Personal
  - PHP
  - Security
  - Unwakeable
  - WordPress
  - wordpress-theme

---
It was brought to my attention a couple days ago that [Unwakeable][1] 1.2 contains a [cross-site scripting (XSS) vulnerability][2] in the search piece. To test to see if you&#8217;re vulnerable, search for this on your Unwakeable site:

<pre></pre>

If you see a javascript popup after searching, you&#8217;re vulnerable to attack and should follow the steps below to fix the vulnerability in Unwakeable 1.2. I&#8217;ve already taken steps to fix this vulnerability in Unwakeable 2.0, which will be released shortly.  
<!--adsense-->

  
To fix your installation of Unwakeable 1.2 you need to edit three files: **serchform.php, theloop.php,** and **header.php**.

### 1. searchform.php

First, open **searchform.php** and change this piece on line 8:

<pre><form method="get" id="searchform" action="<?php echo $_SERVER['PHP_SELF']; ?>">
  </pre>
  
  
  <p>
    to this:
  </p>
  
  
  <pre><form method="get" id="searchform" action="<?php echo htmlspecialchars($_SERVER['PHP_SELF']); ?>">
  </pre>
  
  
  <h3>
    2. theloop.php
  </h3>
  
  
  <p>
    Next, open <strong>theloop.php</strong> and change this piece on line 42:
  </p>
  
  
  <pre>printf(__('Search Results for \'%s\'','k2_domain'), $s);</pre>
  
  
  <p>
    to this:
  </p>
  
  
  <pre>printf(__('Search Results for \'%s\'','k2_domain'), htmlspecialchars($s));</pre>
  
  
  <h3>
    3. header.php
  </h3>
  
  
  <p>
    Finally, open header.php and change this code on line 6:
  </p>
  
  
  <pre>Search for <?php echo $s;</pre>


<p>
  to this:
</p>


<pre>Search for <?php echo htmlspecialchars($s);</pre>


<p>
  That's it, once you've made those three changes you should no longer be vulnerable to this cross-site scripting attack.  To make sure, just perform the search I mentioned above.  It should no longer produce a javascript pop-up.
</p>


<p>
  You can find out more about this vulnerability at <a href="http://blogsecurity.net/wordpress/articles/article-070607/">blogsecurity.net</a>.  They have a tool called <a href="http://blogsecurity.net/wordpress/tools/wp-scanner/">WordPress Scanner</a> that will scan your WordPress installations for security problems.
</p>


<p>
  Let me know if this fix doesn't work for any of you.		
</p>


<div class="wpulike wpulike-default " >
  <div class="wp_ulike_general_class wp_ulike_is_not_liked">
    <button type="button"
					aria-label="Like Button"
					data-ulike-id="2330"
					data-ulike-nonce="b7705b3ae7"
					data-ulike-type="likeThis"
					data-ulike-template="wpulike-default"
					data-ulike-display-likers="0"
					data-ulike-disable-pophover="0"
					class="wp_ulike_btn wp_ulike_put_image wp_likethis_2330"></button><span class="count-box"></span>			
  </div>
  
</div>


<p>
  <a href='#' class='later-button-el'></a>
</p>


<div class='what-next'>
  <h2>
    Well, now what?
  </h2>
  
  
  <div class='hire'>
    <h3>
      Work with Me
    </h3>
    
    
    <p>
      I'm available for hire and always taking new clients, big and small. Got a project or an idea you'd like to discuss? Startup plan but no developer to make it happen? Just <a href='https://www.longren.io/contact/'>get in touch</a>, I'd love to see if I can help you out!
    </p>
    </p>
  </div>
  
  
  <div class='hire'>
    <h3>
      Leave some Feedback
    </h3>
    
    
    <p>
      Got a question or some updated information releavant to this post? Please, <a href='#respond' title='Leave a comment'>leave a comment</a>! The comments are a great way to get help, I read them all and reply to nearly every comment. Let's talk. ðŸ˜€
    </p>
    </p>
  </div>
  
  
  <div class='now-what-bottom-ad'>
    <h3>
      Longren.io is proudly hosted by <a href='https://www.digitalocean.com/?refcode=cbf49d0481c8'>DigitalOcean</a>
    </h3>
    
    
    <p>
      <span class='do_link'><a href='https://www.digitalocean.com/?refcode=cbf49d0481c8' rel='nofollow' target='_blank'><img alt='DigitalOcean' border='0' src='https://i0.wp.com/longren.io/wp-content/uploads/2014/03/digitalocean.png?w=1100&#038;ssl=1' data-recalc-dims="1" /></a></span><br />
          <!--

<h3>Need Cloud Monitoring? Try Mist.io!</h3>

<span class='do_link'><a href='http://mist.io/?ref=tyler' rel='nofollow' target='_blank'><img alt='Mist.io' border='0' src='https://i0.wp.com/longren.io/wp-content/uploads/2014/04/mistio.jpg?w=1100&#038;ssl=1' data-recalc-dims="1"></a></span>-->
        </div>
      </div>

 [1]: http://www.longren.org/wordpress/unwakeable/
 [2]: http://en.wikipedia.org/wiki/Cross-site_scripting